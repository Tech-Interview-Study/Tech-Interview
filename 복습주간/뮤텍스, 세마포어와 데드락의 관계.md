# 뮤텍스, 세마포어와 데드락의 관계

## 세마포어가 어떻게 race condition을 방지하는지?

[ 의문 점 ] 

</br>

세마포어는 뮤텍스와 다르게 접근 개수를 지정하는 방법이므로 여러 스레드가 접근할 수 있어 race condition을 방지하지 못할 것 같은데 어떻게 해결하는지 의문이 들었음.

세마포어에 접근제한이 2 이상인 경우에는 임계영역에도 여러개의 스레드가 동시에 접근할 수 있다면, 세마포어를 사용해도 동시에 데이터를 업데이트하게 되면 문제가 발생할 텐데, 이런 부분을 감수하고서 세마포어를 사용하는 건지?


[ 해결 내용 ]

</br>

세마포어 동작 방법
- wait(), P(S)
자원의 점유를 시도하는 것으로 자원의 수가 0 이상인 경우 해당 자원의 값을 1 감소시킨다.

0보다 아래인 경우 사용 가능한 자원이 없다는 것으로 block()로 대기한다.

- signal(), V()
임계 영역의 사용이 끝났다면 자원의 수를 증가시킨다.

세마포어는 사용가능한 자원의 수를 명시하고, wait와 signal을 통해 이 값을 빼고, 더하며 음수가 되는지 체크하여 한번에 접근할 수 있는 프로세스(스레드)의 수를 제한한다. 


세마포어의 한계점
세마포어의 값이 1보다 큰 경우 여러 스레드가 임계영역에 동시 접근 가능하기에 race condition을 완전히 방지할 순 없다. 그러나 접근 스레드 수를 제한하고 접근 순서를 정리하여 동기화를 돕기에 race conndition문제를 완화할 수 있다. 



[ 참고 ]
- [세마포어가 Race condition을 방지하는 방법](https://rebro.kr/176)
- [운영체제 8장 - 프로세스 관리(5) : 세마포(semaphore) - 세마포어 동작 과정이 잘 설명되어있음](https://copycode.tistory.com/62)
